**注意：此处提交的是目标代码为 MIPS/PCODE 的编译器程序！！！**

【问题描述】

请在词法分析、语法分析及错误处理作业的基础上，为编译器实现语义分析、代码生成功能。输入输出及处理要求如下：

（1）需根据文法规则及语义约定，采用自顶向下的语法制导翻译技术，进行语义分析并生成目标代码（任选其一）；

（2）对于选择生成**MIPS**的编译器，约定如下：

完成编译器，将源文件（统一命名为testfile.txt）编译生成MIPS汇编并输出到文件（统一命名为mips.txt），具体要求包括：

​      a）需自行设计四元式中间代码，再从中间代码生成MIPS汇编，请设计实现输出中间代码的有关函数（输出要求见课件下载中“编译技术实验中间代码格式2022”文档），本次作业不考核，后续会有优化前后中间代码的输出及评判(输出文件命名为学号_姓名_优化前/后中间代码.txt)

​    b）若选择此项任务，后续的作业需参加竞速排序，请提前预留代码优化有关的接口，并设计方便切换开启/关闭优化的模式

​    c）自行调试时，可使用Mars仿真器（使用方法见“竞速排序及仿真器使用说明2022”），提交到平台的编译器只需要能按统一的要求生成MIPS汇编代码文件即可

​    d）**此类提交的编译器请仅读取testfile.txt文件并生成相应的MIPS代码，编译器自身不要读入标准输入中的内容。**

【输入形式】testfile.txt为符合文法要求的测试程序。另外可能存在来自于标准输入的数据。

【输出形式】 按照选择的目标代码不同分为三种：

 1）生成 MIPS 的编译器

   按如上要求将目标代码生成结果输出至 mips.txt 中。

【样例输入】testfile.txt 如下：

```
int test;
int main(){
    printf("Hello World\n");
    test = getint();
    printf("%d",test);
    return 0;
}
```

标准输入 input.txt 如下：

```
2022
```

【样例输出】 mips只需标准输出

```
Hello World
2022
```





【样例输入】testfile.txt如下：

```
int main() {
    int res;
    res = getint();
    printf("res = %d\n", res);
    return 0;
}
```

（注意：评测机提供的 IO 函数同时支持字符串输出和单个字符输出（分别对应 MARS 的 4 号和 11 号 syscall），同学们可以自行选择输出方式（选取一种或混合使用均可），具体用法参见样例。如果选用字符串方式输出，可参考 [字符串常量的表示](https://llvm.org/docs/LangRef.html#complex-constants) 与 [getelementptr 指令](https://llvm.org/docs/LangRef.html#getelementptr-instruction) 。）



【评分标准】按与预期结果不一致的行数扣分，每项扣10%。

【文档要求】完成代码生成阶段设计文档 （在之前的文档基础上扩充完成）    

【特别说明】

 **（1）注意：此处提交的是目标代码为 \**\*\*MIPS/PCODE\*\**\* 的编译器程序！！！**

 （2）本次作业是为了让同学们尽快实现一个完整的编译器，测试程序中仅涉及常量声明、变量声明、读语句、写语句、赋值语句，加减乘除模除等运算语句、函数定义及调用语句。

 （3）三种目标代码任选其一完成，若生成PCODE代码或LLVM IR代码，成绩总分为85分；若生成MIPS汇编，成绩总分为100分；请严格按照目标代码的输入输出要求完成，以免造成评判错误。

 （4）本次作业仅用正确的测试程序进行考核，但产生的编译器应具有错误处理能力。

 （5）LLVM IR代码需在linux环境下执行，选择这类目标代码的同学可以在实验的仿真平台上进行调试

【目标代码说明】

 （2）MIPS代码可以选择基础指令及伪指令，不能选择宏指令； MARS 使用 4.5 版本（课程组修改版本），请在教学平台的“课件下载”中获取课程组修改过的版本Mars-for-Compiler-2022.jar以及“竞速排序及仿真器使用说明2022”文档查看具体要求
